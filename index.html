<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fluid Unit Converter</title>
  <style>
    :root {
      --bg: #0b0f14;        /* near-black */
      --panel: #12171f;     /* dark slate */
      --muted: #1a2330;     /* deep gray-blue */
      --edge: #242e3c;      /* border */
      --text: #f2f5f7;      /* almost white */
      --subtle: #a7b0bd;    /* secondary text */
      --ok: #2bd576;        /* subtle green accent */
      --accent: #6ea8fe;    /* primary accent */
      --warn: #f0b429;      /* amber accent */
      --shadow: 0 10px 30px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.02);
      --radius: 18px;
    }

    html, body { height: 100%; }
    body {
      margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1200px 800px at 20% -10%, #101521, transparent 60%),
                  radial-gradient(1000px 700px at 100% 0%, #0f141e, transparent 50%),
                  var(--bg);
      color: var(--text);
      line-height: 1.45;
    }

    .wrap { max-width: 1100px; margin: 40px auto; padding: 0 18px; }
    header { display: flex; align-items: center; justify-content: space-between; gap: 14px; margin-bottom: 16px; }
    h1 { font-size: clamp(24px, 4vw, 36px); margin: 0; letter-spacing: .5px; }
    .sub { color: var(--subtle); font-size: 14px; }

    .card { background: linear-gradient(180deg, #141b26, #0f151f 50%, #0d131b); border: 1px solid var(--edge); border-radius: var(--radius); box-shadow: var(--shadow); }

    .grid { display: grid; grid-template-columns: 1.2fr 1fr; gap: 18px; }
    @media (max-width: 920px) { .grid { grid-template-columns: 1fr; } }

    .controls { padding: 18px; display: grid; gap: 14px; }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    @media (max-width: 560px) { .row { grid-template-columns: 1fr; } }

    label { font-size: 12px; text-transform: uppercase; letter-spacing: .12em; color: var(--subtle); display:block; margin-bottom: 8px; }
    input[type="text"], select { width: 100%; padding: 14px 14px; border-radius: 12px; border: 1px solid var(--edge); background: #0b1119; color: var(--text); outline: none; box-shadow: inset 0 1px 0 rgba(255,255,255,.03); }
    input::placeholder { color: #8c96a6; }

    .btnbar { display: flex; gap: 10px; flex-wrap: wrap; }
    button { cursor: pointer; border: 1px solid var(--edge); background: linear-gradient(180deg, #1a2330, #151c27); color: var(--text); padding: 12px 14px; border-radius: 12px; transition: transform .08s ease, filter .2s ease; box-shadow: var(--shadow); }
    button:hover { filter: brightness(1.05); }
    button:active { transform: translateY(1px); }

    .swap { display: inline-flex; align-items: center; gap: 10px; }

    .result { padding: 18px; border-top: 1px solid var(--edge); background: #0a1017; border-bottom-left-radius: var(--radius); border-bottom-right-radius: var(--radius); }
    .result h2 { margin: 0 0 8px 0; font-size: clamp(18px, 2.6vw, 24px); }
    .result .val { font-variant-numeric: tabular-nums; font-weight: 700; }
    .muted { color: var(--subtle); }

    /* Conversions list */
    .list { padding: 18px; display: grid; gap: 10px; max-height: 560px; overflow: auto; border-left: 1px solid var(--edge); }
    @media (max-width: 920px) { .list { border-left: none; } }

    .item { display: grid; grid-template-columns: auto 1fr auto; gap: 12px; align-items: center; padding: 12px; border: 1px solid var(--edge); border-radius: 12px; background: #0b121a; }
    .tag { min-width: 8px; height: 28px; border-radius: 6px; }
    .tag.metric { background: linear-gradient(180deg, #2bd576, #208c52); }
    .tag.us { background: linear-gradient(180deg, #6ea8fe, #3f6fb8); }
    .tag.imperial { background: linear-gradient(180deg, #f0b429, #b88312); }

    .item .u { font-weight: 600; }
    .copybtn { font-size: 12px; padding: 8px 10px; }

    .foot { margin-top: 14px; font-size: 12px; color: var(--subtle); }
    .pill { display:inline-block; padding: 2px 8px; border:1px solid var(--edge); border-radius:999px; margin-left:6px; background:#0b1119; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Fluid Unit Converter</h1>
        <div class="sub">Fast, accurate conversions between metric, US customary, and imperial volume units — in a sleek black & gray UI.</div>
      </div>
    </header>

    <section class="card grid" role="region" aria-label="Converter">
      <div>
        <div class="controls">
          <div class="row">
            <div>
              <label for="amount">Amount</label>
              <input id="amount" type="text" inputmode="decimal" placeholder="Enter a number (e.g., 2.5)" aria-describedby="amount-help" />
              <div id="amount-help" class="foot">Tip: You can paste values like "1,234.56" or "1 234,56" — we handle both.</div>
            </div>
            <div>
              <label for="from">From Unit</label>
              <select id="from"></select>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="to">To Unit</label>
              <select id="to"></select>
            </div>
            <div>
              <label>&nbsp;</label>
              <div class="btnbar">
                <button class="swap" id="swap" title="Swap units" aria-label="Swap units">
                  <span>Swap</span>
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M7 7h13M7 7l4-4M7 7l4 4M17 17H4m13 0l-4-4m4 4l-4 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
                </button>
                <button id="copy" class="copybtn" title="Copy result" aria-label="Copy result">Copy Result</button>
                <button id="clear" class="copybtn" title="Clear" aria-label="Clear">Clear</button>
              </div>
            </div>
          </div>
        </div>

        <div class="result" aria-live="polite">
          <h2><span class="val" id="outVal">—</span> <span class="muted" id="outUnit"></span></h2>
          <div class="muted">Converted from <span id="fromVal">—</span> <span id="fromUnit">—</span>.</div>
          <div class="foot">Colour code: <span class="pill">Metric</span> <span class="pill">US Customary</span> <span class="pill">Imperial</span></div>
        </div>
      </div>

      <aside class="list" id="list" aria-label="All conversions list">
        <!-- dynamically filled with all unit conversions -->
      </aside>
    </section>

    <p class="foot">Accuracy note: All conversions are exact using standard definitions (e.g., 1 US gallon = 231 in³ = 3.785411784 L; 1 Imperial gallon = 4.54609 L). Rounding is applied for display only.</p>
  </div>

  <script>
    // =========================
    // Units (base: liter)
    // =========================
    const UNITS = [
      // Metric
      { key: 'ml',  name: 'Milliliter (mL)',      system: 'metric',   toLiter: 1/1000 },
      { key: 'l',   name: 'Liter (L)',            system: 'metric',   toLiter: 1 },
      { key: 'm3',  name: 'Cubic meter (m³)',     system: 'metric',   toLiter: 1000 },
      { key: 'cm3', name: 'Cubic centimeter (cm³)', system: 'metric', toLiter: 1/1000 },

      // US customary
      { key: 'tsp', name: 'Teaspoon (US)',        system: 'us',       toLiter: 0.00492892159375 },
      { key: 'tbsp',name: 'Tablespoon (US)',      system: 'us',       toLiter: 0.01478676478125 },
      { key: 'floz_us', name: 'Fluid ounce (US fl oz)', system: 'us', toLiter: 0.0295735295625 },
      { key: 'cup', name: 'Cup (US)',             system: 'us',       toLiter: 0.2365882365 },
      { key: 'pt_us', name: 'Pint (US)',          system: 'us',       toLiter: 0.473176473 },
      { key: 'qt_us', name: 'Quart (US)',         system: 'us',       toLiter: 0.946352946 },
      { key: 'gal_us', name: 'Gallon (US)',       system: 'us',       toLiter: 3.785411784 },

      // Imperial (UK)
      { key: 'floz_imp', name: 'Fluid ounce (Imp fl oz)', system: 'imperial', toLiter: 0.0284130625 },
      { key: 'pt_imp', name: 'Pint (Imperial)',   system: 'imperial', toLiter: 0.56826125 },
      { key: 'qt_imp', name: 'Quart (Imperial)',  system: 'imperial', toLiter: 1.1365225 },
      { key: 'gal_imp', name: 'Gallon (Imperial)',system: 'imperial', toLiter: 4.54609 },
    ];

    const unitByKey = Object.fromEntries(UNITS.map(u => [u.key, u]));

    // Populate selects grouped by system
    function populateUnitSelects() {
      const groups = {
        metric: document.createElement('optgroup'),
        us: document.createElement('optgroup'),
        imperial: document.createElement('optgroup')
      };
      groups.metric.label = 'Metric';
      groups.us.label = 'US Customary';
      groups.imperial.label = 'Imperial (UK)';

      UNITS.forEach(u => {
        const opt1 = document.createElement('option');
        opt1.value = u.key; opt1.textContent = u.name;
        const opt2 = opt1.cloneNode(true);
        groups[u.system].appendChild(opt1);
        groups[u.system].appendChild(opt2);
      });

      const from = document.getElementById('from');
      const to = document.getElementById('to');
      from.innerHTML = '';
      to.innerHTML = '';

      // Append in order: metric, us, imperial
      for (const sys of ['metric','us','imperial']) {
        from.appendChild(groups[sys].cloneNode(true));
        to.appendChild(groups[sys].cloneNode(true));
      }

      // Defaults
      from.value = 'l';
      to.value = 'gal_us';
    }

    // Parse flexible number inputs (handles commas & spaces, EU decimals)
    function parseFlexibleNumber(str) {
      if (typeof str !== 'string') return NaN;
      // If there are both comma and dot, assume comma is thousands
      const hasComma = str.includes(',');
      const hasDot = str.includes('.');
      let cleaned = str.trim().replace(/\s+/g,'');
      if (hasComma && hasDot) {
        cleaned = cleaned.replace(/,/g,'');
      } else if (hasComma && !hasDot) {
        // Treat comma as decimal
        cleaned = cleaned.replace(',', '.');
      } else {
        // Only dot or neither
        cleaned = cleaned;
      }
      return Number(cleaned);
    }

    function toLiters(value, fromKey) {
      const u = unitByKey[fromKey];
      return value * u.toLiter;
    }

    function fromLiters(liters, toKey) {
      const u = unitByKey[toKey];
      return liters / u.toLiter;
    }

    function formatNumber(n) {
      if (!isFinite(n)) return '—';
      const abs = Math.abs(n);
      const opts = abs !== 0 && (abs < 0.001 || abs >= 1e6)
        ? { notation: 'scientific', maximumFractionDigits: 6 }
        : { maximumFractionDigits: 8 };
      return new Intl.NumberFormat(undefined, opts).format(n);
    }

    // Render result & list
    function renderAll() {
      const amtStr = document.getElementById('amount').value;
      const fromK = document.getElementById('from').value;
      const toK = document.getElementById('to').value;
      const amt = parseFlexibleNumber(amtStr);

      const outValEl = document.getElementById('outVal');
      const outUnitEl = document.getElementById('outUnit');
      const fromValEl = document.getElementById('fromVal');
      const fromUnitEl = document.getElementById('fromUnit');

      if (!isFinite(amt)) {
        outValEl.textContent = '—';
        outUnitEl.textContent = '';
        fromValEl.textContent = '—';
        fromUnitEl.textContent = '';
        document.getElementById('list').innerHTML = '';
        return;
      }

      const liters = toLiters(amt, fromK);
      const out = fromLiters(liters, toK);

      outValEl.textContent = formatNumber(out);
      outUnitEl.textContent = unitByKey[toK].name;
      fromValEl.textContent = formatNumber(amt);
      fromUnitEl.textContent = unitByKey[fromK].name;

      // Build list of all conversions
      const list = document.getElementById('list');
      list.innerHTML = '';
      UNITS.forEach(u => {
        const div = document.createElement('div');
        div.className = 'item';
        const tag = document.createElement('div');
        tag.className = 'tag ' + u.system;
        const name = document.createElement('div');
        name.innerHTML = `<span class="u">${u.name}</span>`;
        const val = document.createElement('div');
        val.className = 'val';
        val.textContent = formatNumber(fromLiters(liters, u.key));

        const copy = document.createElement('button');
        copy.className = 'copybtn';
        copy.textContent = 'Copy';
        copy.addEventListener('click', () => {
          navigator.clipboard.writeText(val.textContent + ' ' + u.name).catch(()=>{});
          copy.textContent = 'Copied!';
          setTimeout(() => copy.textContent = 'Copy', 900);
        });

        div.appendChild(tag);
        div.appendChild(name);
        div.appendChild(val);
        div.appendChild(copy);
        list.appendChild(div);
      });
    }

    // Events
    function bindEvents() {
      const ids = ['amount','from','to'];
      ids.forEach(id => document.getElementById(id).addEventListener('input', renderAll));
      document.getElementById('swap').addEventListener('click', () => {
        const from = document.getElementById('from');
        const to = document.getElementById('to');
        [from.value, to.value] = [to.value, from.value];
        renderAll();
      });
      document.getElementById('copy').addEventListener('click', () => {
        const val = document.getElementById('outVal').textContent;
        const unit = document.getElementById('outUnit').textContent;
        if (val && unit) {
          navigator.clipboard.writeText(`${val} ${unit}`).catch(()=>{});
          const btn = document.getElementById('copy');
          btn.textContent = 'Copied!';
          setTimeout(() => btn.textContent = 'Copy Result', 900);
        }
      });
      document.getElementById('clear').addEventListener('click', () => {
        document.getElementById('amount').value = '';
        renderAll();
        document.getElementById('amount').focus();
      });

      // Enter to select amount
      document.getElementById('amount').addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          document.getElementById('to').focus();
        }
      });
    }

    // Init
    populateUnitSelects();
    bindEvents();
    // Prefill demo amount
    document.getElementById('amount').value = '1';
    renderAll();
  </script>
</body>
</html>
